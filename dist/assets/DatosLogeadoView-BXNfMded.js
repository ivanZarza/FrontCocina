import{b as r,_ as I,s as E,c as d,a as e,F as h,r as D,e as S,o as m,t as i,i as w}from"./index-Bd3iIt6k.js";import{s as L}from"./servicioRecetasLogeado-C_906RXM.js";import{V as k}from"./VentanaToast-ZZRtjFVJ.js";const y={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"http://localhost:3000"},{VITE_API_URL:P}=y;class V{constructor(){this.datosUsuario=r([]),this.recetasUsuario=r([]),this.ingredientesUsuario=r([])}async obtenerDatosUsuario(){try{const t=await fetch(`${P}/api/listadelacompra/me/datos`,{credentials:"include"});if(!t.ok){const p=await t.json();throw new Error(p.error||`Error al obtener los datos  ${t.status}`)}const l=await t.json();return this.datosUsuario.value=l.usuario,this.recetasUsuario.value=l.recetas,this.ingredientesUsuario.value=l.ingredientes,l}catch(t){throw console.error("Error al obtener los datos del usuario:",t),t}}}const A=new V,N={class:"container"},C={class:"bienvenida"},O={class:"contenidoUsuario"},x={class:"recetas"},B={class:"postalRecetas"},j=["onClick"],J=["onClick"],$={class:"ingredientes"},F={class:"postales"},M={__name:"DatosLogeadoView",setup(g){const t=L,l=w(),p=r({}),v=r([]),_=r([]),b=r(!1),c=r(""),f=async()=>{try{const s=A;await s.obtenerDatosUsuario(),p.value=s.datosUsuario;const o=s.recetasUsuario,a=s.ingredientesUsuario;return v.value=o.value.map(n=>{let u=JSON.parse(n.datosJSON);return{id:n.id,usuarioId:n.usuarioId,nombre:u.nombre,numeroDePersonas:u.numeroDePersonas,principal:u.principal,acompanamiento:u.acompanamiento,condimentos:u.condimentos,descripcion:u.descripcion}}),_.value=a.value,v.value,_.value}catch(s){c.value=s.message,U(),setTimeout(()=>{l.push({name:"login"})},2100)}};function R(s){let o=JSON.parse(localStorage.getItem("recetasUsuario"))||[];o.find(n=>n.nombre===s.nombre)?c.value="La receta ya existe en la lista de la compra":(o.push({nombre:s.nombre,numeroDePersonas:s.numeroDePersonas,principal:s.principal,acompanamiento:s.acompanamiento,condimentos:s.condimentos,descripcion:s.descripcion,id:s.id,usuarioId:s.usuarioId}),localStorage.setItem("recetasUsuario",JSON.stringify(o)),c.value="Receta añadida a la lista de la compra"),U()}function T(s){t.borrarRecetaUsuario(s),c.value="Receta eliminada de la base de datos",U(),setTimeout(()=>{f()},2100)}function U(){b.value=!0,setTimeout(()=>{b.value=!1},2e3)}return E(f),(s,o)=>(m(),d(h,null,[e("div",N,[e("div",C,[o[4]||(o[4]=e("h3",null,"Aquí podrás recuperar tus recetas guardadas, también podrás crear, modificar o eliminar tus propios ingredientes",-1)),e("div",O,[e("div",x,[o[2]||(o[2]=e("h1",null,"Recetas creadas por ti",-1)),(m(!0),d(h,null,D(v.value,a=>(m(),d("div",{key:a.id},[e("div",B,[e("h3",null,"Nombre: "+i(a.nombre)+" para "+i(a.numeroDePersonas)+" personas",1),o[0]||(o[0]=e("h3",null,"¿Quieres pasar esta receta a la lista de la compra?",-1)),e("button",{onClick:n=>R(a)},"SI",8,j),o[1]||(o[1]=e("h3",null,"¿Quieres borrar la receta de la base de datos?",-1)),e("button",{onClick:n=>T(a.id)},"BORRAR RECETA",8,J)])]))),128))]),e("div",$,[o[3]||(o[3]=e("h3",null,"Ingredientes creados por ti",-1)),e("div",F,[(m(!0),d(h,null,D(_.value,a=>(m(),d("div",{class:"postalIngredientes",key:a.nombre},[e("p",null,"Nombre: "+i(a.nombre),1),e("p",null,"Tipo: "+i(a.tipo),1),e("p",null,"Principal: "+i(a.principal),1),e("p",null,"Acompañamiento: "+i(a.acompañamiento),1),e("p",null,"Condimento: "+i(a.condimento),1)]))),128))])])])])]),e("div",null,[S(k,{verToast:b.value,mensajeToast:c.value},null,8,["verToast","mensajeToast"])])],64))}},G=I(M,[["__scopeId","data-v-6723cec9"]]);export{G as default};
