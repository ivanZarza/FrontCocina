import{_ as w,b as c,c as s,a,F as d,r as m,t as l,u as j,m as _,w as q,v as x,e as M,o as n,n as z,i as J}from"./index-Bd3iIt6k.js";import{s as $}from"./servicioRecetasLogeado-C_906RXM.js";import{V as H}from"./VentanaToast-ZZRtjFVJ.js";import{h as K}from"./html2pdf-CHyY-T61.js";const Q={class:"pagRecetas"},W=["onClick"],X={key:0,class:"container"},Y={class:"resumen"},Z={class:"listaIngredientes"},aa={class:"listaIngredientes"},ea={class:"listaIngredientes"},oa={class:"descripcionFinal"},ta={class:"listaFinal"},sa={class:"ingredientesFinales"},na={key:0,class:"compraAñadida"},la={class:"ingredientesAñadidos"},ra={class:"agregarCompra"},ua={__name:"CompraLogeadoView",setup(ia){const D=$,u=c([]),t=c(u.value[0]),v=c(0),p=c([]),f=c({nombre:""}),b=c(!1),g=c(""),T=J(),R=c(null);function S(){u.value=JSON.parse(localStorage.getItem("recetasUsuario")||"[]"),A()}S();function y(r){t.value=r}function A(){u.value.length>0?(t.value=u.value[v.value],console.log(t.value)):(t.value=null,window.alert('No hay recetas que mostrar, por favor crea una receta en la zona de "CREAR RECETEAS" o añade una receta guardada, desde la zona "MIS DATOS" .'),T.push({name:"datosUsuario"}))}function I(){v.value<u.value.length-1&&(v.value++,A())}function P(){v.value>0&&(v.value--,A())}async function F(){const r=t.value;await D.guardarRecetaUsuario(r),g.value="Receta guardada en tu base de datos.",h()}function G(){const r=u.value.filter(e=>e.nombre!==t.value.nombre);r.length===0?localStorage.removeItem("recetasUsuario"):localStorage.setItem("recetasUsuario",JSON.stringify(r)),u.value=r,g.value="Receta borrada de la lista de la compra.",h()}function O(){localStorage.removeItem("recetasUsuario"),t.value=null,T.push({name:"datosUsuario"})}function U(r){const e={};return r.forEach(C=>{["principal","acompañamiento","condimentos"].forEach(k=>{C[k]&&C[k].forEach(i=>{const E=i.nombre;e[E]?e[E].cantidad+=i.cantidad:e[E]={nombre:i.nombre,cantidad:i.cantidad,tipo:i.tipo,principal:i.principal,acompañamiento:i.acompañamiento,condimento:i.condimento}})})}),Object.values(e)}const L=U(u.value);function N(){p.value.push({...f.value}),f.value={nombre:"",cantidad:0}}function B(){p.value=[]}const V=()=>{const r={margin:1,filename:"lista-de-compras.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}};R.value&&K().set(r).from(R.value).save()};function h(){b.value=!0,setTimeout(()=>{b.value=!1},2e3)}return(r,e)=>(n(),s(d,null,[a("div",Q,[(n(!0),s(d,null,m(u.value,o=>(n(),s("div",{key:o.nombre},[a("button",{onClick:C=>y(o),class:z({recetaActiva:t.value.nombre===o.nombre})},l(o.nombre),11,W)]))),128))]),t.value?(n(),s("div",X,[a("div",Y,[a("div",{class:"pag"},[a("button",{onClick:P},"RECETA ANTERIOR"),a("button",{onClick:I},"SIGUIENTE RECETA")]),a("h1",null,"Receta: "+l(t.value.nombre),1),a("h2",null,"Para "+l(t.value.numeroDePersonas)+" "+l(t.value.numeroDePersonas===1?"persona":"personas"),1),e[3]||(e[3]=a("h2",null,"Principal",-1)),a("div",Z,[a("ol",null,[(n(!0),s(d,null,m(t.value.principal,o=>(n(),s("li",{key:o.id},l(o.nombre)+" - "+l(o.cantidad)+" Grs",1))),128))])]),e[4]||(e[4]=a("h2",null,"Acompañamiento",-1)),a("div",aa,[a("ol",null,[(n(!0),s(d,null,m(t.value.acompanamiento,o=>(n(),s("li",{key:o.id},l(o.nombre)+" - "+l(o.cantidad)+" Grs",1))),128))])]),e[5]||(e[5]=a("h2",null,"Condimentos",-1)),a("div",ea,[a("ol",null,[(n(!0),s(d,null,m(t.value.condimentos,o=>(n(),s("li",{key:o.id},l(o.nombre)+" - "+l(o.cantidad)+" Grs",1))),128))])]),e[6]||(e[6]=a("h2",null,[a("strong",null,"Descripción:")],-1)),a("div",oa,[a("pre",null,l(t.value.descripcion),1)]),a("div",{class:"guardarReceta"},[e[1]||(e[1]=a("h3",null,"Guarda tu receta en la base de datos",-1)),a("button",{onClick:F},"GUARDA TU RECETA")]),a("div",{class:"borrarRecetas"},[e[2]||(e[2]=a("h3",null,"Borra la receta seleccionada o todas las recetas de la lista de la compra",-1)),a("button",{onClick:G},"BORRAR RECETA SELECCIONADA"),a("button",{onClick:O},"BORRAR TODAS LAS RECETAS")])]),a("div",ta,[a("div",{class:"PDF",ref_key:"generarPDFRef",ref:R},[e[8]||(e[8]=a("h2",null,"Estas son las cantidades de ingredientes que tienes que comprar para las recetas que has creado:",-1)),a("div",sa,[a("ul",null,[(n(!0),s(d,null,m(j(L),o=>(n(),s("li",{key:o.nombre},l(o.nombre)+" - "+l(o.cantidad)+" Grs",1))),128))])]),p.value.length>0?(n(),s("div",na,[e[7]||(e[7]=a("h2",null,"Estos son los productos que añadiste",-1)),a("div",la,[a("ul",null,[(n(!0),s(d,null,m(p.value,o=>(n(),s("li",{key:o.nombre},l(o.nombre),1))),128))])])])):_("",!0)],512),e[9]||(e[9]=a("h2",null,"Puedes agregar productos a la lista de la compra",-1)),a("div",ra,[q(a("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>f.value.nombre=o),placeholder:"Nombre del producto"},null,512),[[x,f.value.nombre]]),a("button",{onClick:N},"Agregar a la lista de la compra"),a("button",{onClick:B},"BORRAR COMPRA AGREGADA")]),a("div",{class:"btnPdf"},[a("button",{onClick:V},"Generar PDF")])]),a("div",null,[M(H,{verToast:b.value,mensajeToast:g.value},null,8,["verToast","mensajeToast"])])])):_("",!0)],64))}},pa=w(ua,[["__scopeId","data-v-4d79b0b4"]]);export{pa as default};
